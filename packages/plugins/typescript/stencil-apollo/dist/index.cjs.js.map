{"version":3,"file":"index.cjs.js","sources":["../../../dist/plugins/typescript/stencil-apollo/src/config.js","../../../dist/plugins/typescript/stencil-apollo/src/visitor.js","../../../dist/plugins/typescript/stencil-apollo/src/index.js"],"sourcesContent":["export var StencilComponentType;\n(function (StencilComponentType) {\n    StencilComponentType[\"functional\"] = \"functional\";\n    StencilComponentType[\"class\"] = \"class\";\n})(StencilComponentType || (StencilComponentType = {}));\n//# sourceMappingURL=config.js.map","import { ClientSideBaseVisitor, getConfigValue, } from '@graphql-codegen/visitor-plugin-common';\nimport { StencilComponentType } from './config';\nimport autoBind from 'auto-bind';\nimport { paramCase } from 'param-case';\nimport { pascalCase } from 'pascal-case';\nexport class StencilApolloVisitor extends ClientSideBaseVisitor {\n    constructor(schema, fragments, rawConfig) {\n        super(schema, fragments, rawConfig, {\n            componentType: getConfigValue(rawConfig.componentType, StencilComponentType.functional),\n            noExport: rawConfig.componentType === StencilComponentType.class,\n        });\n        autoBind(this);\n    }\n    getImports() {\n        const baseImports = super.getImports();\n        const imports = [];\n        const hasOperations = this._collectedOperations.length > 0;\n        if (!hasOperations) {\n            return baseImports;\n        }\n        if (this.config.componentType === StencilComponentType.class) {\n            imports.push(`import 'stencil-apollo';`);\n            imports.push(`import { Component, Prop, h } from '@stencil/core';`);\n        }\n        else {\n            imports.push(`import * as StencilApollo from 'stencil-apollo';`);\n            imports.push(`import { h } from '@stencil/core';`);\n        }\n        return [...baseImports, ...imports];\n    }\n    _buildOperationFunctionalComponent(node, documentVariableName, operationType, operationResultType, operationVariablesTypes) {\n        const operationName = this.convertName(node.name.value);\n        const propsTypeName = this.convertName(operationName + 'Props');\n        const rendererSignature = pascalCase(`${operationType}Renderer`) + `<${operationResultType}, ${operationVariablesTypes}>`;\n        const apolloStencilComponentTag = paramCase(`Apollo${operationType}`);\n        const componentName = this.convertName(`${operationName}Component`);\n        const propsVar = `\nexport type ${propsTypeName} = {\n    variables ?: ${operationVariablesTypes};\n    inlist ?: StencilApollo.${rendererSignature};\n};\n      `;\n        const component = `\nexport const ${componentName} = (props: ${propsTypeName}, children: [StencilApollo.${rendererSignature}]) => (\n  <${apolloStencilComponentTag} ${operationType.toLowerCase()}={ ${documentVariableName} } { ...props } renderer={ children[0] } />\n);\n      `;\n        return [propsVar, component].filter(a => a).join('\\n');\n    }\n    _buildClassComponent(node, documentVariableName, operationType, operationResultType, operationVariablesTypes) {\n        const componentName = this.convertName(node.name.value + 'Component');\n        const apolloStencilComponentTag = paramCase(`Apollo${operationType}`);\n        const rendererSignature = pascalCase(`${operationType}Renderer`);\n        return `\n@Component({\n    tag: '${paramCase(`Apollo${pascalCase(node.name.value)}`)}'\n})\nexport class ${componentName} {\n    @Prop() renderer: import('stencil-apollo').${rendererSignature}<${operationResultType}, ${operationVariablesTypes}>;\n    @Prop() variables: ${operationVariablesTypes};\n    render() {\n        return <${apolloStencilComponentTag} ${operationType.toLowerCase()}={ ${documentVariableName} } variables={ this.variables } renderer={ this.renderer } />;\n    }\n}\n      `;\n    }\n    buildOperation(node, documentVariableName, operationType, operationResultType, operationVariablesTypes) {\n        switch (this.config.componentType) {\n            case StencilComponentType.class:\n                return this._buildClassComponent(node, documentVariableName, operationType, operationResultType, operationVariablesTypes);\n            case StencilComponentType.functional:\n                return this._buildOperationFunctionalComponent(node, documentVariableName, operationType, operationResultType, operationVariablesTypes);\n            default:\n                return '';\n        }\n    }\n}\n//# sourceMappingURL=visitor.js.map","import { visit, concatAST, Kind } from 'graphql';\nimport { StencilApolloVisitor } from './visitor';\nimport { extname } from 'path';\nexport const plugin = (schema, documents, config) => {\n    const allAst = concatAST(documents.map(v => v.document));\n    const allFragments = [\n        ...allAst.definitions.filter(d => d.kind === Kind.FRAGMENT_DEFINITION).map(fragmentDef => ({\n            node: fragmentDef,\n            name: fragmentDef.name.value,\n            onType: fragmentDef.typeCondition.name.value,\n            isExternal: false,\n        })),\n        ...(config.externalFragments || []),\n    ];\n    const visitor = new StencilApolloVisitor(schema, allFragments, config);\n    const visitorResult = visit(allAst, { leave: visitor });\n    return {\n        prepend: visitor.getImports(),\n        content: ['', visitor.fragments, ...visitorResult.definitions.filter(t => typeof t === 'string')].join('\\n'),\n    };\n};\nexport const validate = async (schema, documents, config, outputFile) => {\n    if (extname(outputFile) !== '.tsx') {\n        throw new Error(`Plugin \"stencil-apollo\" requires extension to be \".tsx\"!`);\n    }\n};\nexport { StencilApolloVisitor };\n//# sourceMappingURL=index.js.map"],"names":["ClientSideBaseVisitor","getConfigValue","pascalCase","paramCase","concatAST","Kind","visit","extname"],"mappings":"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"}